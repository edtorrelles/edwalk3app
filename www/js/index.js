var contentType="application/x-www-form-urlencoded; charset=utf-8";if(window.XDomainRequest){contentType="text/plain";}
var $window=$(window);$window.scroll(function(){if($window.scrollTop()>$('#sticky-anchor').offset().top){$('#istop').addClass("displayblock");}else{$('#istop').removeClass("displayblock");}});function log(msg){var p=document.getElementById('log');p.innerHTML=msg+"\n"+p.innerHTML;}
function encodeRFC5987ValueChars(str){return encodeURIComponent(str).replace(/['()]/g,escape).replace(/\*/g,'%2A').replace(/%(?:7C|60|5E)/g,unescape);}
function doMenu(id){if($("#"+id).css('display')=='none'){$("#submenu div").css("display","none");$("#"+id).css("display","block");}else{$("#"+id).css("display","none");}}
var firstArrayMenu=new Array();var totquiet=true;var edwalk=document.getElementById('edwalk');var numitems=0;var perpage=8;var favsID=new Array();var catsNameId=new Array();var parentMenu=document.getElementById("menu");var aMenu=parentMenu.getElementsByTagName("a");for(var i=0;i<aMenu.length;i++){aMenu[i].addEventListener("click",function(event){event.preventDefault();$('#menu a').removeClass('selec');this.className="selec";},false);}
var app={initialize:function(){this.store=new LocalStorageStore();this.store.crearArray(function(favs){if(typeof favs!=='undefined'&&favs.length>0){var l=favs.length;for(var i=0;i<l;i++){var item=JSON.parse(favs[i]);favsID.push(item.id);}}});this.bindEvents();},bindEvents:function(){document.addEventListener('deviceready',this.onDeviceReady,false);this.onDeviceReady();document.addEventListener("online",this.onConnectionOnline,false);document.addEventListener("offline",this.onConnectionOffline,false);var obj=document.getElementById('flippopup');var dits=JSON.parse('{ "pageX1":"xxx" , "pageX2":"xxx", "id":"xxx", "pageY1":"xxx", "pageY2":"xxx" }');obj.addEventListener('touchend',function(event){var px=dits.pageX2-dits.pageX1;if(!isNaN(px)){if(px>400){var id=$("#exnexprev #prev").attr("laid");if(!isNaN(id)){id=$("#exnexprev #next").attr("laid");}
app.hideExtra(id);}else if(px>100){var id=$("#exnexprev #next").attr("laid");app.prevExtra(id);}else if(px<-100){var id=$("#exnexprev #prev").attr("laid");app.nextExtra(id);}}
dits=JSON.parse('{ "pageX1":"xxx" , "pageX2":"xxx", "id":"xxx", "pageY1":"xxx", "pageY2":"xxx" }');},false);obj.addEventListener('touchmove',function(event){var touch=event.changedTouches[0];if(dits.id==='xxx'||dits.id!=touch.identifier){dits.id=touch.identifier;dits.pageX1=touch.pageX;dits.pageY1=touch.pageY;}
dits.pageX2=touch.pageX;dits.pageY2=touch.pageY;},false);},onDeviceReady:function(){app.onSearchWebEvent('contruct');app.receivedEvent('deviceready');document.addEventListener("menubutton",doMenu,false);window.analytics.startTrackerWithId('UA-71798739-1');},onConnectionOnline:function(){},onConnectionOffline:function(){alert("ERROR: Offline!!!!");},receivedEvent:function(id){app.onSearchWebEvent('art',1);navigator.splashscreen.hide();},onSearchWebEvent:function(who,page,cat,catname){var url='http://edwalk.com/app/';if(who!=='like'&&who!=="contruct"){if($('#loading').length){}else{$('body').append('<div id="loading" style="text-align:center;"><div class="loadcontent"><img src="img/logo.png" alt="edwalk" /><br/>loading <div class="spinner"> <div class="bounce1"></div> <div class="bounce2"></div> <div class="bounce3"></div> </div> </div></div>');}
app.hideExtra();var cattts="";var lologo="";if(page===1){if(typeof catname!='undefined'){cattts="<span style='color:#fff;'>"+decodeURIComponent(catname)+" </span>";window.analytics.trackView('app cat: '+decodeURIComponent(catname));}else{window.analytics.trackView('app home');cattts="<span>edwalk </span>";lologo="<img src='img/woki22.png' alt='edwalk' /><br/>";}
edwalk.innerHTML="<div id='topedbar'><h2>"+lologo+""+cattts+""+who+"</h2></div><div id='sticky-anchor'></div><div id='istop' class=''><h2>"+cattts+""+who+"</h2></div>";numitems=0;}
$("#submenu div").css("display","none");menuOpen=false;}
var lang=this.store.findlang();$.ajax({type:'GET',url:'http://edwalk.com/app/',async:false,crossDomain:true,data:{'cap':'N1bl1m69','who':who,'page':page,'cat':cat,'lang':lang},contentType:contentType,jsonp:"callback",jsonpCallback:'jsonpCallback',dataType:'json',beforeSend:function(){},complete:function(){},success:function(response){if(who!=="like"){if(page==1){window.scrollTo(0,0);}
$('#loading .loadcontent').append(' success ');if(who==="contruct"){app.createMenu(response);}else{app.onNewPrint(who,response,page,cat);}
$('#edwalk .camera').imagesLoaded().always(function(instance){}).done(function(instance){}).fail(function(){$item.addClass('is-broken');}).progress(function(instance,image){if(screen.width>700){var alto=image.img.height;if(alto<200){$(image.img).css({"height":'200px',"width":'auto'});}else{var menos=(200-alto)/2;$(image.img).css({"margin-top":menos});}}
var $item=$(image.img).parent();$item.removeClass('is-loading');if(!image.isLoaded){$item.addClass('is-broken');}});}
setTimeout(function(){$('#loading').remove();},2000);},error:function(e){$("#edwalk").append('<h1>error loading content</h1>');setTimeout(function(){$('#loading').remove();},2000);}});},drawImage:function(item,fav){var catss="";var text2="";$.each(item.lascats,function(j,xats){if(j>0){catss+=", ";}
catss+='<a href="javascript:void(0)" onclick="app.hideExtra('+item.id+'); app.onSearchWebEvent(\'art\',1,'+xats.term_id+',\''+encodeRFC5987ValueChars(xats.name)+'\'); ">'+xats.name+'</a>';text2+=' #'+encodeRFC5987ValueChars(xats.name)+' , ';});var t=item.idate.split(/[- :]/);var url='http://edwalk.com/uploads/'+t[0]+'/'+t[1]+'/i5-'+item.thumb_image;var ssize="";if(typeof item.size!='undefined'){ssize="<div class='artsize'>"+item.size+"</div>";}
var artfav='';artfav+='<a class="share" href="javascript:void(0)" onclick="window.plugins.socialsharing.share(\'edwalk art: '+item.title+' ( '+decodeURIComponent(text2)+' )  \', \'edwalk art\', \''+url+'\', \'http://edwalk.com\')"><img src="img/share.png" alt="share" /></a>';if(fav===true){var imglove="img/fav7.png";}else{var imglove="img/fav2.png";}
if(favsID.indexOf(item.id)!=-1){artfav+="<a class='loveicon' href='javascript:void(0)' onclick='app.removeFavs("+item.id+");'><img src='"+imglove+"' alt='favs' /></a>";}else{artfav+="<a class='loveicon' href='javascript:void(0)' onclick='app.addFavs("+item.id+");'><img src='img/fav1.png' alt='favs' /></a>";}
$('#edwalk').append("<div id='"+item.id+"' class='art' data='"+encodeRFC5987ValueChars(JSON.stringify(item))+"' ><div class='artshadow' onclick='app.showExtra(\""+encodeRFC5987ValueChars(JSON.stringify(item))+"\");' ></div><div class='camera is-loading'><img class='foto' src='"+url+"' alt='"+item.title+"' /></div><div class='artpeu'>"+ssize+"<div class='artfav'>"+artfav+"</div><h2>"+item.title+"</h2><div class='artcats'>"+catss+"</div> </div></div>");},onNewPrint:function(who,response,page,cat){$.each(response,function(i,item){if(who=='blog'){if(typeof cat!='undefined'){$('#edwalk').append("<div id='"+item.id+"' class='art'><h1>"+item.title+"</h1>"+item.content+"</div>");}else{$('#edwalk').append("<div id='"+item.id+"' class='art'><h2><a id='' href='javascript:void(0)' onclick='app.onSearchWebEvent(\"blog\",\""+item.slug+"\");'>"+item.title+"</a></h2><hr/></div>");}}else{app.drawImage(item,false);numitems++;}});app.pagination(page,numitems,cat);},pagination:function(page,numitems,cat){var lang=this.store.findlang();var obj={'end':{'EN':'You reached the end.','ES':'Has alcanzado el final. '},'Load':{'EN':'Load more items','ES':'Cargar más imágenes'}};var nextpage=perpage*page;var fintext="";page++;if(numitems<nextpage){fintext="<span style='color:#ccc;'>"+obj['end'][lang]+"</span>";}else{fintext='<a href="javascript:void(0);" onclick="app.onSearchWebEvent(\'art\','+page+','+cat+');">'+obj['Load'][lang]+'</a>';}
document.getElementById('finale').innerHTML=fintext;},createMenu:function(response){$.each(response,function(i,item){$.each(item,function(j,i2tem){catsNameId[i2tem.name]=i2tem.term_id;catsNameId[i2tem.nameES]=i2tem.term_id;});});this.store.saveMenuArray(response);app.DrawMenu();},DrawMenu:function(){var response=this.store.getMenuArray();var lang=this.store.findlang();var n1=response.tec;var n=n1.length;if(n>1){$('#tec').html('');$.each(response.tec,function(i,item){if(lang==='ES'){var name=item.nameES;}else{var name=item.name;}
$('#tec').append('<li><a href="javascript:void(0)" onclick="app.onSearchWebEvent(\'art\',1,'+item.term_id+',\''+decodeURIComponent(escape(name))+'\');">'+decodeURIComponent(escape(name))+'</a></li>');});}
var m1=response.tem;var m=m1.length;if(m>1){$('#tem').html('');$.each(response.tem,function(i,item){if(lang==='ES'){var name=item.nameES;}else{var name=item.name;}
$('#tem').append('<li><a href="javascript:void(0)" onclick="app.onSearchWebEvent(\'art\',1,'+item.term_id+',\''+decodeURIComponent(escape(name))+'\');">'+decodeURIComponent(escape(name))+'</a></li>');});}
if(!isNaN(response.perpage)){perpage=response.perpage;}},showSettings:function(){var lang=this.store.findlang();var obj={'Settings':{'EN':'Settings','ES':'Configuración'},'DeleteAll':{'EN':'Delete all your favorite pictures','ES':'Borrar todas tus imágenes favoritas'},'selectlang':{'EN':'Select your language','ES':'Selecciona tu idioma'}};var langES='';var langEN='';if(lang==='ES'){langES=' asettSelect ';}else{langEN=' asettSelect ';}
window.scrollTo(0,0);$('#finale').html("");app.hideExtra();$("#submenu div").css("display","none");edwalk.innerHTML="<h2 style='text-align:center;padding:20px 0; background:#151515;'><span style='color:#fff;'>edwalk</span> "+obj['Settings'][lang]+"</h2>";$('#edwalk').append('<div id="about"> \
  <div class="settings2"> \
  <a class="asett" href="javascript:void(0)" onclick="navigator.notification.confirm( \' '+obj['DeleteAll'][lang]+' \', app.clearFavsConfirm, \'edwalk settings\', [\'Detele\',\'Exit\']  );" >'+obj['DeleteAll'][lang]+' <span id="clearfavsresult"></span></a> \
  '+obj['selectlang'][lang]+': <br/> \
  <a class="asett '+langES+'" href="javascript:void(0)" onclick="app.changelanguage( \'ES\' );" >Español <span id="ES"></span></a> \
  <a class="asett '+langEN+'" href="javascript:void(0)" onclick="app.changelanguage( \'EN\' );" >English <span id="EN"></span></a> \
  </div> \
  </div>');window.analytics.trackView('app settings');},changelanguage:function(idioma){this.store.xchangelang(idioma,function(){app.DrawMenu();app.showSettings();});},showAbout:function(){var lang=this.store.findlang();var obj={'about':{'EN':'about','ES':'Sobre '},'Portfolio':{'EN':'Portfolio of Visual Artist','ES':'Portafolio del Artista Visual'},'Painting':{'EN':'Painting, Illustration and sketches','ES':'Pintura, ilustración y bocetos'},'Myname':{'EN':'My name is Eduard Torrelles, after a long time lost in the immensity. I decided to return to the path of art, this is my diary.','ES':'Mi nombre es Eduard Torrelles, después de un largo tiempo perdido en la inmensidad. Decidí volver a la senda del arte, este es mi diario.'},'Settings':{'EN':'Settings','ES':'Configuración '}};window.scrollTo(0,0);$('#finale').html("");app.hideExtra();var d=new Date();$("#submenu div").css("display","none");edwalk.innerHTML="<div id='topedbar'><h2><span style='color:#fff;'>"+obj['about'][lang]+"</span> ed</h2></div><div id='sticky-anchor'></div><div id='istop' class=''><h2><span style='color:#fff;'>"+obj['about'][lang]+"</span> ed</h2></div>";$('#edwalk').append('<div id="about"> \
  <div class="targeta"><img class="aboutlogo" src="img/woki22.png" alt="edwalk" /></div> <h2>'+obj['Portfolio'][lang]+'</h2> \
  <h3>'+obj['Painting'][lang]+'</h3> \
  <p>'+obj['Myname'][lang]+'</p> \
  Bacelona, Spain \
  <p><a href="javascript:void(0)" onclick="window.open(\'http://edwalk.com\', \'_system\');" ><h3><strong>edwalk.com</strong></h3></a></p>  \
  All images © 2000 - '+d.getFullYear()+' Eduard Torrelles  \
  <div class="settings"> \
  <a  href="javascript:void(0)" onclick="app.showSettings();" >'+obj['Settings'][lang]+'<br/><img src="img/settings.png" alt="settings"></a> \
  </div> \
  </div>');window.analytics.trackView('app about');},clearFavsConfirm:function(buttonIndex){if(buttonIndex===1){app.clearFavs();}},clearFavs:function(){this.store.clearAllFavs(function(doo){if(doo==='doit'){$("#clearfavsresult").html('<span class="green"> - erased</span>');}else{$("#clearfavsresult").html('<span class="red"> - ERROR</span>');}});},showFavs:function(){var lang=this.store.findlang();var obj={'likethis':{'EN':'I like this','ES':'Me gusta tu '},'ART':{'EN':'ART','ES':'ARTE'},'willbe':{'EN':'Your favorites will be here','ES':'Tus favoritos estarán aquí'}};edwalk.innerHTML="<h2 style='text-align:center;padding:20px 0; background:#151515;'><span style='color:#fff;'>"+obj['likethis'][lang]+"</span> "+obj['ART'][lang]+"</h2>";window.scrollTo(0,0);$('#finale').html("");app.hideExtra();$("#submenu div").css("display","none");this.store.findAll(function(favs){var l=favs.length;var item;if(l<1){$('#edwalk').append(" <h3 style='text-align:center;padding:20px 0; '>"+obj['willbe'][lang]+" </h3>");}else{for(var i=0;i<l;i++){var item=JSON.parse(favs[i]);app.drawImage(item,true);}
$('#edwalk .camera').imagesLoaded().always(function(instance){}).done(function(instance){}).fail(function(){$item.addClass('is-broken');}).progress(function(instance,image){var result=image.isLoaded?'loaded':'broken';if(screen.width>700){var alto=image.img.height;if(alto<200){$(image.img).css({"height":'200px',"width":'auto'});}else{var menos=(200-alto)/2;$(image.img).css({"margin-top":menos});}}
var $item=$(image.img).parent();$item.removeClass('is-loading');if(!image.isLoaded){$item.addClass('is-broken');}});}});window.analytics.trackView('app show favs');},addFavs:function(id){if(favsID.indexOf(id)!=-1){}else{this.store.addNewFav(id,function(id){app.changeFavs(id);app.onSearchWebEvent('like',id);});}},removeFavs:function(id){this.store.removeNewFav(id,function(id){app.changeFavs(id);});},changeFavs:function(id){var actual=$('#'+id+' .loveicon img').attr("src");if(actual==="img/fav1.png"){$('#return .loveicon img').attr("src","img/fav2.png");$('#return .loveicon').attr("onclick","app.removeFavs("+id+");");$('#'+id+' .loveicon img').attr("src","img/fav2.png");$('#'+id+' .loveicon').attr("onclick","app.removeFavs("+id+");");}else if(actual==="img/fav7.png"){app.hideExtra(id);$('#'+id).remove();}else{$('#'+id+' .loveicon img').attr("src","img/fav1.png");$('#'+id+' .loveicon').attr("onclick","app.addFavs("+id+");");$('#return .loveicon img').attr("src","img/fav1.png");$('#return .loveicon').attr("onclick","app.addFavs("+id+");");}},hideExtra:function(id){if(typeof id!=='undefined'){var toop=$("#"+id).offset().top;window.scrollTo(0,toop);}
$('#flipcontent').removeClass("toleft");$('#extracontent').removeClass("toleft");$('#flipcontent').addClass("outright");$('#flipcontent #extracontent').addClass("outright");setTimeout(function(){$("#edwalk .art").removeClass("openart");});},nextExtra:function(id){if(totquiet){totquiet=false;var datos=$("#edwalk #"+id).next(".art").attr("data");if(typeof datos!=='undefined'){app.showExtra(datos,'next');}else{$("#next").css("display","none");totquiet=true;}}},prevExtra:function(id){if(totquiet){totquiet=false;var datos=$("#edwalk #"+id).prev(".art").attr("data");if(typeof datos!=='undefined'){app.showExtra(datos,'prev');}else{$("#prev").css("display","none");totquiet=true;}}},showExtra:function(extra,side){item=JSON.parse(decodeURIComponent(extra));if(typeof(side)==='undefined'){side='prev';}
$("#edwalk .art").removeClass("openart");$("#"+item.id).addClass("openart");var extraclass='';if(side==='prev'){extraclass="transition stayleft";}else{extraclass="transition stayright";}
var d=document.createElement("div");d.setAttribute("id","flipcontent2");d.setAttribute("class",extraclass);document.getElementById("flippopup").appendChild(d);var t=item.idate.split(/[- :]/);var url='http://edwalk.com/uploads/'+t[0]+'/'+t[1]+'/i5-'+item.thumb_image;var text1="";var text2="";$.each(item.lascats,function(j,xats){text1+='<a href="javascript:void(0)" onclick="app.hideExtra('+item.id+'); app.onSearchWebEvent(\'art\',1,'+xats.term_id+',\''+encodeRFC5987ValueChars(xats.name)+'\'); ">'+xats.name+'</a>';text2+=' #'+encodeRFC5987ValueChars(xats.name)+' , ';});$("#flipcontent2").html('<div id="extraimg"> <div id="eximg"></div> <div id="exfoot"></div> </div> <div id="extracontent" class=" '+extraclass+'" > <div id="return">  <a href="javascript:void(0)" onclick="app.hideExtra();" title="close"><img src="img/close.png" alt="close"></a>  </div> <div id="extitle"></div> <div id="excats"></div> <div id="exsize"></div>  <div id="exnexprev"></div> <div id="exfoot"></div> </div>');$("#flipcontent2 #exnexprev").html('<a id="prev" laid="'+item.id+'" href="javascript:void(0)" onclick="app.prevExtra('+item.id+');" title="prev"><img src="img/prev.png" alt="prev"></a><a id="next" laid="'+item.id+'" href="javascript:void(0)" onclick="app.nextExtra('+item.id+');" title="next"><img src="img/next.png" alt="next"></a>');$("#flipcontent2 #return").html(' <a class="hideextra" href="javascript:void(0)" onclick="app.hideExtra('+item.id+');" title="close"><img src="img/close.png" alt="close"></a> ');var artfav="";var actual=$('#'+item.id+' .loveicon img').attr("src");if(actual==="img/fav7.png"){var imglove="img/fav7.png";}else{var imglove="img/fav2.png";}
artfav+='<a class="share" href="javascript:void(0)" onclick="window.plugins.socialsharing.share(\'edwalk art: '+item.title+'( '+decodeURIComponent(text2)+' )  \', \'edwalk art\', \''+url+'\', \'http://edwalk.com\')"><img src="img/share.png" alt="share" /></a> ';if(favsID.indexOf(item.id)!=-1){artfav+="<a class='loveicon' href='javascript:void(0)' onclick='app.removeFavs("+item.id+");'><img src='"+imglove+"' alt='favs' /></a>"}else{artfav+="<a class='loveicon' href='javascript:void(0)' onclick='app.addFavs("+item.id+");'><img src='img/fav1.png' alt='favs' /></a>"}
$("#flipcontent2 #return").append(artfav);$("#flipcontent2 #eximg").html("<img src='"+url+"' alt='"+item.title+"' />");$("#flipcontent2 #extitle").html('<h2>'+item.title+'</h2>');$("#flipcontent2 #excats").html(text1);$("#flipcontent2 #exsize").html(item.size);setTimeout(function(){if(side==='prev'){$('#flipcontent').addClass("outright");$('#flipcontent #extracontent').addClass("outright");}else{$('#flipcontent').addClass("outleft");$('#flipcontent #extracontent').addClass("outleft");}
$('#flipcontent').removeClass("toleft");$('#flipcontent #extracontent').removeClass("toleft");$('#flipcontent2').addClass("toleft");$('#flipcontent2 #extracontent').addClass("toleft");$('#flipcontent2').removeClass("stayleft");$('#flipcontent2').removeClass("stayright");$('#flipcontent2 #extracontent').removeClass("stayleft");$('#flipcontent2 #extracontent').removeClass("stayright");setTimeout(function(){$('#flipcontent').remove();d.setAttribute("id","flipcontent");$('#flipcontent').scrollTop=0;$('#flipcontent').animate({scrollTop:0},500);totquiet=true;},400);});$("#submenu div").css("display","none");window.analytics.trackView('app popup: '+item.title);}};